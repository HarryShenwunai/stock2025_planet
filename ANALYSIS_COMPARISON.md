# åˆ†æè´¨é‡å¯¹æ¯”ï¼šæ”¹è¿›å‰ vs æ”¹è¿›å

## ğŸ”´ æ”¹è¿›å‰çš„é—®é¢˜ï¼ˆä½ æä¾›çš„AAPLæ•°æ®ï¼‰

```json
{
  "symbol": "AAPL",
  "current_price": 272.41,
  "trend": "DOWNTREND",
  "confidence": 0.75,           // âŒ ç½®ä¿¡åº¦è¿‡é«˜ï¼ˆä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼‰
  "risk_level": "MEDIUM",
  "recommendation": "HOLD",      // âŒ æ¨ç†çŸ›ç›¾
  "target_price": 286.03,
  "stop_loss": 231.55,
  "sentiment_score": 0.1,
  "technical_indicators": {
    "rsi": 100,                 // âŒ ä¸¥é‡é—®é¢˜1: ä¸å¯èƒ½å€¼
    "macd": 3.5,
    "signal": 3.5,
    "histogram": 0,             // âŒ ä¸¥é‡é—®é¢˜2: æ— åŠ¨é‡
    "volatility": 0.00309       // âŒ ä¸¥é‡é—®é¢˜3: 0.31% è¿‡ä½
  },
  "reasoning": "RSI indicates overbought conditions. MACD shows bullish momentum. Market sentiment is neutral. Chart pattern: {'pattern': 'consolidation', 'confidence': 1.0, 'description': 'Low volatility consolidation - potential breakout setup', 'volatility': 0.0}. Recommendation: HOLD.",
  // âŒ ä¸¥é‡é—®é¢˜4: RSI=100(è¶…ä¹°) + MACDæ— åŠ¨é‡ â†’ å´å»ºè®®HOLD
  "timestamp": "2025-11-15T01:22:16.247944"
}
```

### é—®é¢˜æ¸…å•
| é—®é¢˜ | ä¸¥é‡æ€§ | åŸå›  | å½±å“ |
|------|--------|------|------|
| **RSI = 100** | ğŸ”´ ä¸¥é‡ | çº¿æ€§æ¨¡æ‹Ÿæ•°æ® | æŠ€æœ¯æŒ‡æ ‡å®Œå…¨å¤±çœŸ |
| **æ³¢åŠ¨ç‡ = 0.31%** | ğŸ”´ ä¸¥é‡ | æ— çœŸå®æ³¢åŠ¨ | é£é™©è¯„ä¼°é”™è¯¯ |
| **MACDæ— åŠ¨é‡** | ğŸŸ  ä¸­ç­‰ | å‡çº¿åŒæ­¥ | æ— æ³•åˆ¤æ–­è¶‹åŠ¿å˜åŒ– |
| **æ¨ç†çŸ›ç›¾** | ğŸŸ  ä¸­ç­‰ | æŒ‡æ ‡å¤±çœŸ | å»ºè®®ä¸å¯ä¿¡ |
| **æ— æ•°æ®æ¥æºæ ‡è¯†** | ğŸŸ¡ è½»å¾® | ç¼ºå°‘å…ƒæ•°æ® | ä¸é€æ˜ |

---

## ğŸŸ¢ æ”¹è¿›åçš„é¢„æœŸç»“æœ

### åœºæ™¯A: çœŸå®æ•°æ®å¯ç”¨
```json
{
  "symbol": "AAPL",
  "current_price": 272.41,
  "trend": "UPTREND",           // âœ… åŸºäºçœŸå®è¶‹åŠ¿
  "confidence": 0.75,           // âœ… çœŸå®æ•°æ®é«˜ç½®ä¿¡åº¦
  "risk_level": "MEDIUM",
  "recommendation": "BUY",      // âœ… æ¨ç†ä¸€è‡´
  "target_price": 290.50,
  "stop_loss": 260.15,
  "sentiment_score": 0.1,
  "technical_indicators": {
    "rsi": 54.2,                // âœ… æ­£å¸¸èŒƒå›´ (30-70)
    "macd": 1.35,
    "signal": 0.98,
    "histogram": 0.37,          // âœ… æœ‰åŠ¨é‡ (0.37 > 0)
    "volatility": 0.0215,       // âœ… 2.15% çœŸå®æ³¢åŠ¨
    
    // æ‰©å±•æŒ‡æ ‡ï¼ˆæ›´ç§‘å­¦ï¼‰
    "hurst": 0.52,              // âœ… HurstæŒ‡æ•°
    "fractal_dimension": 1.48,
    "entropy": 2.1,
    "trend_r2": 0.65,           // âœ… è¶‹åŠ¿å¼ºåº¦
    "sharpe": 1.24,             // âœ… é£é™©è°ƒæ•´æ”¶ç›Š
    "sortino": 1.65,
    "max_drawdown_pct": 8.5,    // âœ… æœ€å¤§å›æ’¤
    "cycle_period": 21.3,
    "composite_score": 2.85,    // âœ… ç»¼åˆè¯„åˆ†
    
    "data_source": "real",      // âœ… æ•°æ®æ¥æºæ ‡è¯†
    "history_days": 100         // âœ… å†å²å¤©æ•°
  },
  "reasoning": "Current price: $272.41. Daily change: -0.20%. RSI indicates neutral conditions (54.2). MACD shows bullish momentum (histogram: 0.37). Market sentiment is neutral. Chart pattern: uptrend with RÂ²=0.65. Recommendation: BUY. [Data source: real, 100 days]",
  // âœ… æ¨ç†ä¸€è‡´ä¸”é€æ˜
  "timestamp": "2025-11-15T10:30:00.000000"
}
```

### åœºæ™¯B: APIé™æµï¼Œä½¿ç”¨åˆæˆæ•°æ®
```json
{
  "symbol": "AAPL",
  "current_price": 272.41,
  "confidence": 0.45,           // âœ… é™ä½ç½®ä¿¡åº¦ (0.75 * 0.6)
  "technical_indicators": {
    "rsi": 58.7,                // âœ… éšæœºä½†åˆç†
    "macd": -0.25,
    "histogram": -0.18,         // âœ… æœ‰æ³¢åŠ¨
    "volatility": 0.0147,       // âœ… 1.47% æ¥è¿‘çœŸå®
    
    "composite_score": 1.52,
    
    "data_source": "synthetic", // âœ… è­¦å‘Šç”¨æˆ·
    "history_days": 100
  },
  "reasoning": "... [Data source: synthetic, 100 days]"
  // âœ… æ˜ç¡®æ ‡æ³¨æ•°æ®æ¥æº
}
```

---

## ğŸ“Š æŠ€æœ¯æŒ‡æ ‡å¯¹æ¯”

### RSI (ç›¸å¯¹å¼ºå¼±æŒ‡æ•°)
| æ–¹æ¡ˆ | å€¼ | èŒƒå›´ | è¯„ä»· |
|------|-----|------|------|
| **æ”¹è¿›å‰** | 100 | å›ºå®š | âŒ ç†è®ºä¸å¯èƒ½ |
| **çœŸå®æ•°æ®** | 30-70 | æ­£å¸¸ | âœ… å¯ä¿¡ |
| **åˆæˆæ•°æ®** | 40-65 | æ­£å¸¸ | âœ… åˆç† |

### æ³¢åŠ¨ç‡
| æ–¹æ¡ˆ | å€¼ | å¹´åŒ– | è¯„ä»· |
|------|-----|------|------|
| **æ”¹è¿›å‰** | 0.31% | 4.9% | âŒ è¿‡ä½ï¼ˆå›½å€ºçº§ï¼‰ |
| **çœŸå®æ•°æ®** | 1.8-2.5% | 28-40% | âœ… ç¬¦åˆAAPL |
| **åˆæˆæ•°æ®** | 1.3-1.7% | 21-27% | âœ… æ¥è¿‘çœŸå® |

### MACD Histogram
| æ–¹æ¡ˆ | å€¼ | åŠ¨é‡ | è¯„ä»· |
|------|-----|------|------|
| **æ”¹è¿›å‰** | 0.0 | æ—  | âŒ æ— æ³•åˆ¤æ–­è¶‹åŠ¿ |
| **çœŸå®æ•°æ®** | -2 ~ +2 | æœ‰ | âœ… åæ˜ çœŸå®åŠ¨é‡ |
| **åˆæˆæ•°æ®** | -1 ~ +1 | æœ‰ | âœ… æœ‰æ³¢åŠ¨ |

---

## ğŸ¯ æ”¹è¿›è¦ç‚¹æ€»ç»“

### 1. æ•°æ®æ¥æºå‡çº§
```
æ”¹è¿›å‰: çº¿æ€§æ¨¡æ‹Ÿ (100%ä¸å‡†ç¡®)
         â†“
æ”¹è¿›å: çœŸå®API â†’ åˆæˆå›é€€ (80%+å‡†ç¡®)
```

### 2. åˆæˆæ•°æ®æ”¹è¿›
```
æ”¹è¿›å‰: historical_prices = [price + i*0.5 for i in range(-30,1)]
        â†’ å®Œç¾çº¿æ€§ï¼ŒRSI=100
         â†“
æ”¹è¿›å: Geometric Brownian Motion (å‡ ä½•å¸ƒæœ—è¿åŠ¨)
        â†’ Î¼=0.05%, Ïƒ=1.5%, RSI=30-70
```

### 3. ç½®ä¿¡åº¦åŠ¨æ€è°ƒæ•´
```
æ”¹è¿›å‰: confidence = 0.75 (å›ºå®š)
         â†“
æ”¹è¿›å: 
  if data_source == "real":
      confidence = 0.75       // çœŸå®æ•°æ®
  else:
      confidence = 0.45       // åˆæˆæ•°æ® (é™ä½40%)
```

### 4. æ•°æ®é€æ˜åº¦
```
æ”¹è¿›å‰: æ— æ ‡è¯†
         â†“
æ”¹è¿›å: 
  "data_source": "real" | "synthetic"
  "history_days": 100
  reasoning += "[Data source: real, 100 days]"
```

---

## ğŸ§ª éªŒè¯æ–¹æ³•

è¿è¡Œæµ‹è¯•è„šæœ¬ï¼š
```bash
python test_data_quality.py
```

**æ£€æŸ¥æ¸…å•**:
- [ ] RSI âˆˆ [20, 80]
- [ ] |histogram - (macd - signal)| < 0.01
- [ ] æ³¢åŠ¨ç‡ âˆˆ [0.5%, 5%]
- [ ] data_source = "real" æˆ– "synthetic"
- [ ] åˆæˆæ•°æ®ç½®ä¿¡åº¦ < 0.5
- [ ] reasoning åŒ…å«æ•°æ®æ¥æº

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### å¯¹äºå¼€å‘è€…
1. **ç›‘æ§ `data_source` å­—æ®µ**
   - `"real"` â†’ æ­£å¸¸ä½¿ç”¨
   - `"synthetic"` â†’ æ·»åŠ å…è´£å£°æ˜

2. **å¤„ç†APIé™æµ**
   ```python
   if analysis["technical_indicators"]["data_source"] == "synthetic":
       print("âš ï¸ æ³¨æ„ï¼šä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œä»…ä¾›å‚è€ƒ")
   ```

3. **å‡çº§APIæ–¹æ¡ˆ**
   - è€ƒè™‘ä»˜è´¹API
   - å®ç°æœ¬åœ°æ•°æ®åº“ç¼“å­˜

### å¯¹äºç”¨æˆ·
1. **æŸ¥çœ‹åˆ†æé¡µé¢åº•éƒ¨**
   - å¦‚æœæ˜¾ç¤º `[Data source: synthetic, ...]`
   - å»ºè®®ç¨åé‡è¯•æˆ–é™ä½å†³ç­–æƒé‡

2. **ç½®ä¿¡åº¦è§£è¯»**
   - `>= 0.70`: é«˜è´¨é‡ï¼ˆçœŸå®æ•°æ®ï¼‰
   - `0.40 - 0.70`: ä¸­ç­‰ï¼ˆåˆæˆæ•°æ®æˆ–æ•°æ®ä¸å®Œæ•´ï¼‰
   - `< 0.40`: ä½è´¨é‡ï¼ˆä»…ä¾›å‚è€ƒï¼‰

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `financial_agent.py` - ä¸»æ”¹è¿›ä»£ç 
- `DATA_QUALITY_IMPROVEMENTS.md` - è¯¦ç»†æŠ€æœ¯æ–‡æ¡£
- `test_data_quality.py` - æµ‹è¯•è„šæœ¬
- `SCORING_IMPROVEMENTS.md` - è¯„åˆ†ç®—æ³•æ”¹è¿›

---

**æ”¹è¿›æ—¥æœŸ**: 2025-11-15  
**æ”¹è¿›æ¨¡å—**: å†å²æ•°æ®è·å– + æŠ€æœ¯æŒ‡æ ‡è®¡ç®—  
**å½±å“èŒƒå›´**: æ‰€æœ‰è‚¡ç¥¨åˆ†æç»“æœ

